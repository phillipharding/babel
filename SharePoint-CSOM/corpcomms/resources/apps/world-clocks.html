<script type='text/javascript' src='/_catalogs/masterpage/Buzz365/js/moment-2.9.0.min.js'></script>
<script type='text/javascript' src='/_catalogs/masterpage/Buzz365/js/moment-timezone-with-data-2010-2020.min.js'></script>

<style type='text/css'>
.world-clocks {
	background-color: #0099A5;
	padding: 10px;
	color: #FFF;
	min-height: 138px;
}
.world-clocks .clock {
	float: left;
	margin-right: 22px;
}
.world-clocks div:last-child {
	margin-right: 0;
}
.world-clocks::after {
	float: none;
	clear: both;
}
.outer_face {
	position: relative;
	width: 110px;
	height: 110px;
	
	-moz-border-radius: 110px;
	-webkit-border-radius: 110px;
	border-radius: 110px;

	box-shadow: inset 0 0 10px gray;
	border: 5px solid white;
}
.outer_face::before,
.outer_face::after {
	/* 12-6 and 9-3 hour markers */
	content: "";
	position: absolute;
	width: 10px;
	height: 100%;
	background: white;
	z-index: 0;
	left: 50%;
	margin-left: -5px;
	top: 0;
}
.outer_face::after {
	/* 9-3 time marker specifically */
	-moz-transform: rotate(90deg);
	-ms-transform: rotate(90deg);
	-webkit-transform: rotate(90deg);
	transform: rotate(90deg);
}
.outer_face::before,
.outer_face::after,
.outer_face .marker {
	/* All hour markers */
	content: "";
	position: absolute;
	width: 4px;
	height: 100%;
	background: white;
	z-index: 0;
	left: 50%;
	margin-left: -2px;
	top: 0;
}

.outer_face .marker {
	background: white;
	width: 2px;
	margin-left: -1px;
}
.outer_face .marker.oneseven {
	-moz-transform: rotate(30deg);
	-ms-transform: rotate(30deg);
	-webkit-transform: rotate(30deg);
	transform: rotate(30deg);
}
.outer_face .marker.twoeight {
	-moz-transform: rotate(60deg);
	-ms-transform: rotate(60deg);
	-webkit-transform: rotate(60deg);
	transform: rotate(60deg);
}
.outer_face .marker.fourten {
	-moz-transform: rotate(120deg);
	-ms-transform: rotate(120deg);
	-webkit-transform: rotate(120deg);
	transform: rotate(120deg);
}
.outer_face .marker.fiveeleven {
	-moz-transform: rotate(150deg);
	-ms-transform: rotate(150deg);
	-webkit-transform: rotate(150deg);
	transform: rotate(150deg);
}
.inner_face {
	position: relative;
	width: 88%;
	height: 88%;
	background: #0099A5;
	-moz-border-radius: 1000px;
	-webkit-border-radius: 1000px;
	border-radius: 1000px;
	z-index: 100;
	left: 6%; /* center DIV horizontally (100%-88% / 2) */
	top: 6%; /* center DIV vertically (100%-88% / 2) */
}
.inner_face::before {
	/* clock center dot small */
	content: "";
	width: 8px;
	height: 8px;
	-moz-border-radius: 8px;
	-webkit-border-radius: 8px;
	border-radius: 8px;

	margin-left: -4px;
	margin-top: -4px;
	background: white;
	position: absolute;
	top: 50%;
	left: 50%;
	box-shadow: 0 0 30px gray;
}
.inner_face::after {
	content: "";
	position: absolute;
	width: 100%;
	font: normal 0.8em Arial;
	color: white;
	text-align: center;
	top: 80%;
	text-transform: uppercase;
}
.london .inner_face::after { content: "london"; }
.newyork .inner_face::after { content: "new york"; }
.shanghai .inner_face::after { content: "shanghai"; }
.tokoyo .inner_face::after { content: "tokoyo"; }

.hand,
.hand.hour {
	position: absolute;
	width: 4px; /* default width of hands/ hour hand */
	height: 30%; /* default height of hands/ hour hand */
	top: 20%; /* offset hand vertically by 20% so its bottom is at center of clock */
	left: 50%; /* offset hand horiz by 50% so its left is at center of clock */
	margin-left: -2px; /* Account for hand width to center hand horizonally */
	background: white;
	-moz-transform: rotate(0deg);
	-ms-transform: rotate(0deg);
	-webkit-transform: rotate(0deg);
	transform: rotate(0deg);
	-moz-transform-origin: bottom; /* Set transform origin to center bottom */
	-ms-transform-origin: bottom;
	-webkit-transform-origin: bottom;
	transform-origin: bottom;
	z-index: -1;
	-moz-box-shadow: 0 0 3px gray;
	-webkit-box-shadow: 0 0 3px gray;
	box-shadow: 0 0 3px gray;

	-moz-border-radius: 10px;
	-webkit-border-radius: 10px;
	border-radius: 10px;
}
.hand.minute {
	/* minute hand (2nd longest) */
	height: 45%;
	top: 5%;
	width: 6px;
	margin-left: -3px;
}
.hand.second {
	/* second hand (longest) */
	height: 50%;
	width: 2px;
	margin-left: -1px;
	top: 0;
	background: red;
}
</style>

<div class="world-clocks">
	<div class="clock london" data-timezone="Europe/London">
		<div class="outer_face">
			<div class="marker oneseven"></div>
			<div class="marker twoeight"></div>
			<div class="marker fourten"></div>
			<div class="marker fiveeleven"></div>
			<div class="inner_face">
				<div class="hand hour"></div>
				<div class="hand minute"></div>
				<div class="hand second"></div>
			</div>
		</div>
	</div>
	<div class="clock newyork" data-timezone="America/New_York">
		<div class="outer_face">
			<div class="marker oneseven"></div>
			<div class="marker twoeight"></div>
			<div class="marker fourten"></div>
			<div class="marker fiveeleven"></div>
			<div class="inner_face">
				<div class="hand hour"></div>
				<div class="hand minute"></div>
				<div class="hand second"></div>
			</div>
		</div>
	</div>
	<div class="clock shanghai" data-timezone="Asia/Shanghai">
		<div class="outer_face">
			<div class="marker oneseven"></div>
			<div class="marker twoeight"></div>
			<div class="marker fourten"></div>
			<div class="marker fiveeleven"></div>
			<div class="inner_face">
				<div class="hand hour"></div>
				<div class="hand minute"></div>
				<div class="hand second"></div>
			</div>
		</div>
	</div>
	<div class="clock tokoyo" data-timezone="Japan">
		<div class="outer_face">
			<div class="marker oneseven"></div>
			<div class="marker twoeight"></div>
			<div class="marker fourten"></div>
			<div class="marker fiveeleven"></div>
			<div class="inner_face">
				<div class="hand hour"></div>
				<div class="hand minute"></div>
				<div class="hand second"></div>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">

(function(window, $) {
"use strict";
var refreshFn = function(f) { setTimeout(f, 1000); };
/* yeah, so the requestAnimationFrame technique causes FireFox to consume CPU resources, quite alot!!!!
window.requestAnimationFrame
                               || window.mozRequestAnimationFrame
                               || window.webkitRequestAnimationFrame
                               || window.msRequestAnimationFrame
                               || function(f) { setTimeout(f, 1000/60); };*/

function updateClock($clock) {
	var
		timezone = $clock.data('timezone') || 'Europe/London',
		$hands = $clock.find('.hand'),
		clockdate = moment().tz(timezone);
console.log(timezone);
console.log(clockdate.format());
console.log(clockdate.hour());
console.log(clockdate.minute());
console.log(clockdate.second());
console.log(clockdate.millisecond());
	var
		hour_as_degree = ( clockdate.hour() + clockdate.minute()/60 ) / 12 * 360,
		minute_as_degree = clockdate.minute() / 60 * 360,
		second_as_degree = ( clockdate.second() + clockdate.millisecond()/1000 ) /60 * 360;
	$hands.filter('.hour').css({transform: 'rotate(' + hour_as_degree + 'deg)' });
	$hands.filter('.minute').css({transform: 'rotate(' + minute_as_degree + 'deg)' });
	$hands.filter('.second').css({transform: 'rotate(' + second_as_degree + 'deg)' });
}
function updateAllClocks() {
	$('.clock').each(function() {
		updateClock($(this));
	});
	refreshFn(updateAllClocks);
}

$(function() {
	refreshFn(updateAllClocks);
});

})(window,jQuery);

</script>